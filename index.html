<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>the sound of a FRUM</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- ðŸ”Š ë°°ê²½ìŒì•… ë‘ ê³¡ ìˆœì°¨ ë°˜ë³µ + ì‚¬ìš´ë“œ í—ˆìš© ë²„íŠ¼ -->
  <audio id="bgm" preload="auto" playsinline></audio>

  <div id="sound-gate" style="
      position:fixed; inset:0; display:none; 
      align-items:center; justify-content:center;
      background:rgba(0,0,0,.55); z-index:9999;">
    <button id="sound-gate-btn" style="
        padding:12px 18px; border:0; border-radius:10px; 
        background:#00adb5; color:#fff; font-size:16px; cursor:pointer;">
      ðŸ”Š ì‚¬ìš´ë“œ ì¼œê¸°
    </button>
  </div>

  <section class="hero">
    <!-- ì˜¤ë¡œë¼ ë ˆì´ì–´ (ì°½ë¬¸ ë§ˆìŠ¤í¬) -->
    <div class="aurora-layer">
      <div class="aurora a1"></div>
      <div class="aurora a2"></div>
    </div>

    <!-- í”½ì…€ ì•„ì´í…œë“¤: ì´ë¯¸ì§€ ê²½ë¡œëŠ” ì „ë¶€ images/*, ìœ„ì¹˜ëŠ” CSSì—ì„œ %, ìž¬ìƒëª©ë¡ì€ data-playlist ë¡œ ì—°ê²° -->
    <img src="images/dapyo2.png"   class="item person1" alt="ì‚¬ëžŒ1"
         data-playlist="https://www.youtube.com/embed/2rNEWolWnDU?si=3qOVKQRyCd14JsV-">
    <img src="images/minesanim.png" class="item person2" alt="ì‚¬ëžŒ2"
         data-playlist="https://www.youtube.com/embed/YaJiLIF25H0?si=0fNUaf-ODDTofi_g">
    <img src="images/namchakim.png" class="item person3" alt="ì‚¬ëžŒ3"
         data-playlist="https://www.youtube.com/embed/Q0OhmGD-4-E?si=t42A39RUNpvrwn10">
    <img src="images/suin.png"      class="item person4" alt="ì‚¬ëžŒ4"
         data-playlist="https://www.youtube.com/embed/CYsNs7Zp_gU?si=Yhw9iAppmLZjUcPr">
    <img src="images/hamster.png"   class="item hamster" alt="í–„ìŠ¤í„°"
         data-playlist="https://www.youtube.com/embed/uxLOLtrcivg?si=2o52KFxbZxtpsMqu">
    <img src="images/fish1.png"     class="item plant1"  alt="í™”ë¶„1"
         data-playlist="https://www.youtube.com/embed/r2ko422xW0w?si=ybbK6e_IAOsQYzgv">
    <img src="images/fish2.png"     class="item plant2"  alt="í™”ë¶„2"
         data-playlist="https://www.youtube.com/embed/videoseries?si=05RZeCWrq64vdRlU&amp;list=PLAjsGI3oJ_af8F7BeyNY_AOPcT_jg7nlV">
    <img src="images/mirro.png"     class="item mirror"  alt="ê±°ìš¸"
         data-playlist="https://www.youtube.com/embed/MuTFf9bxoLU?si=ufWqLYt2fsd_I3a3">
  </section>

  <!-- YouTube ëª¨ë‹¬ íŒì—… -->
  <div id="yt-popup" class="popup" aria-hidden="true">
    <div class="popup-inner" role="dialog" aria-modal="true" aria-label="YouTube Playlist">
      <button id="popup-close" class="popup-close" aria-label="ë‹«ê¸°">âœ•</button>
      <iframe id="yt-player" src="" allow="autoplay; encrypted-media" allowfullscreen></iframe>
    </div>
  </div>

  <script>
    // ===== ë°°ê²½ìŒì•… ì œì–´ (ë‘ ê³¡ ìˆœì°¨ ë°˜ë³µ) =====
    const bgm = document.getElementById('bgm');
    const soundGate = document.getElementById('sound-gate');
    const soundGateBtn = document.getElementById('sound-gate-btn');

    const tracks = ['audio/office1.mp3', 'audio/office2.mp3'];
    let currentTrack = 0;

    function loadTrack(i) {
      bgm.src = tracks[i];
      // ìž¬ìƒ ì‹œë„ (ìžë™ìž¬ìƒ ì°¨ë‹¨ ì‹œ ì‹¤íŒ¨ ê°€ëŠ¥)
      bgm.play().catch(() => {});
    }

    // ì„ í˜¸ ë³¼ë¥¨ (ì›í•˜ë©´ ì¡°ì ˆ)
    bgm.volume = 0.65;

    // íŽ˜ì´ì§€ ë¡œë“œ í›„ ì²« ê³¡ ìž¬ìƒ ì‹œë„
    function tryAutoPlay() {
      loadTrack(currentTrack);
      const p = bgm.play();
      if (p && typeof p.then === 'function') {
        p.then(() => {
          soundGate.style.display = 'none';
        }).catch(() => {
          // ìžë™ìž¬ìƒì´ ë§‰ížŒ ê²½ìš°, í•œ ë²ˆë§Œ í—ˆìš© ë°›ë„ë¡ ê²Œì´íŠ¸ í‘œì‹œ
          soundGate.style.display = 'flex';
        });
      }
    }
    document.addEventListener('DOMContentLoaded', tryAutoPlay);

    // ì‚¬ìš©ìžê°€ ì‚¬ìš´ë“œ í—ˆìš© ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ìž¬ìƒ í—ˆìš©ë¨
    soundGateBtn?.addEventListener('click', () => {
      loadTrack(currentTrack);
      bgm.play().finally(() => {
        soundGate.style.display = 'none';
      });
    });

    // í•œ ê³¡ì´ ëë‚˜ë©´ ë‹¤ìŒ ê³¡ìœ¼ë¡œ (ë‘ ê³¡ ìˆœí™˜)
    bgm.addEventListener('ended', () => {
      currentTrack = (currentTrack + 1) % tracks.length;
      loadTrack(currentTrack);
    });

    // ===== ìœ íŠœë¸Œ ëª¨ë‹¬ ì œì–´ + ë°°ê²½ìŒì•… ë™ê¸°í™” =====
    const popup  = document.getElementById('yt-popup');
    const player = document.getElementById('yt-player');
    const close  = document.getElementById('popup-close');

    // ì•„ì´í…œ í´ë¦­ â†’ data-playlist ì½ì–´ì„œ ëª¨ë‹¬ ì—´ê¸°
    document.querySelectorAll('.item').forEach(el => {
      el.addEventListener('click', () => {
        const url = el.dataset.playlist;
        if (!url) return;

        // ìœ íŠœë¸Œ ì—´ë¦´ ë•Œ ë°°ê²½ìŒì•… ì¼ì‹œì •ì§€
        if (!bgm.paused) bgm.pause();

        // ìžë™ìž¬ìƒ & ê´€ë ¨ì±„ë„ ìµœì†Œí™”
        player.src = `${url}&autoplay=1&rel=0`;
        popup.style.display = 'flex';
        popup.setAttribute('aria-hidden', 'false');
      });
    });

    // ë‹«ê¸°
    function closePopup() {
      popup.style.display = 'none';
      popup.setAttribute('aria-hidden', 'true');
      player.src = ''; // ìœ íŠœë¸Œ ì •ì§€

      // íŒì—… ë‹«ìœ¼ë©´ ë°°ê²½ìŒì•… ìž¬ê°œ ì‹œë„
      bgm.play().catch(() => {});
    }

    close.addEventListener('click', closePopup);
    popup.addEventListener('click', (e) => {
      if (e.target === popup) closePopup(); // ë°”ê¹¥ í´ë¦­ìœ¼ë¡œ ë‹«ê¸°
    });
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closePopup();
    });

    // íƒ­ ì „í™˜ ë°°ë ¤: ë– ë‚˜ë©´ ì¼ì‹œì •ì§€, ë³µê·€ ì‹œ ìž¬ìƒ ì‹œë„
    document.addEventListener('visibilitychange', () => {
      if (document.hidden) {
        if (!bgm.paused) bgm.pause();
      } else {
        // ì‚¬ìš©ìž ì œìŠ¤ì²˜ê°€ ìžˆì—ˆë˜ ì„¸ì…˜ì´ë©´ ìž¬ìƒë¨
        bgm.play().catch(() => {});
      }
    });
  </script>

</body>
</html>
